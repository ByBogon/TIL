# 분산 처리 환경 구축

### Scalability
- 시스템의 늘어나는 작업량을 자원을 추가함으로써 처리하는 능력, 시스템이 더 많은 작업을 처리하기 위해 이를 감당할 리소스를 추가하는 것도 하나의 Scalability

### Scale Up vs Scale Out

#### - Scale up
> - 서버 확장의 가장 쉬운 방법
> - 서버의 사양을 높이는 것, 수직적 확장. 하나의 기존 서버에 자원(ex: cpu, ram, 메모리 등)을 추가하거나 서버 자체를 고사양의 서버로 교체하여 서버의 성능을 향상시키는 것
- 장점: stateful 서비스 구현에 수월, 이에 대한 데이터 정합성 보장
- 단점: 비용, 성능 확장의 한계, 하나의 서버에 급격하게 많은 트래픽이 집중되어 장애가 발생하면 대체할 서버가 없으므로 시스템 전체의 중단으로 이어짐, 즉 단일 실패지점(SPOF) 발생시 해결 방안 없음
- Scale up을 통해서 서버를 확장하면 모든 데이터 처리가 단일 서버에서 이루어지므로 데이터가 자주 업데이트 되어 데이터의 일관성이나 정합성의 보장이 필요한 환경에서 사용됨. 대표적으로 데이터베이스 서버에 적합

#### - Scale out
> - 서버의 수를 늘리는 것, 수평적 확장. 기존 서버와 비슷한 사양의 새로운 서버 여러대를 추가하여 서버를 재구성하는 것을 말함. 즉, 서버를 병렬적으로 확장
> - 장점: 기존 서버와 비슷한 사양 혹은 그보다 낮은 사양의 서버를 사용하기 때문에 Scale up 에 비해서는 비용이 저렴. 또한 필요에 따라 서버를 증설하고 제거하는 것이 용이하기 때문에 좀 더 유연한 확장 가능. 여러 서버로 트래픽을 분산시킬 수 있어 장애 발생 가능성이 낮고 만약 서버 한대에 장애가 생겨 운영할 수 없는 상황이 생겨도 나머지 서버들이 작업을 나눠서 처리하면 되기 때문에 문제 없이 서비스 제공 가능, 즉 SPOF 발생시 대처 가능
> - 단점: 처음부터 분산 서버 환경에 맞게 설계한 경우가 아니라면 이를 구성하는 데에 시간적 비용 발생, 이러한 환경 유지와 관리를 위해 전문적 지식과 노하우가 절대적으로 필요
> - 분산서버 환경을 위해서는 로드밸런싱, 데이터 파티셔닝, 데이터와 서비스에 대한 이중화 등의 다양한 지식을 가지고 있어야하는데 특히 로드밸런싱은 필수. 병목현상을 방지하기 위해 각 서버에 걸리는 부하를 균등하게 분산시키는 것이 로드밸런싱. 이 외에도 여러 서버들 간에 세션과 같은 상태정보를 어떻게 공유해야 할지에 관한 문제도 해결해야함.
> - 비교적 단순하지만 많은 처리를 동시에 진행해야 하는 상황에서 주로 사용 됨. 여러 서버에서 동시에 데이터가 처리되기 떄문에 데이터의 변화가 비교적 적게 일어나고, 일어나더라도 정합성 유지가 어렵지 않은 경우에 적절하다. 대표적으로는 웹 서버에 적합


### 로드밸런서 (Load Balancer)
- 로드밸런싱: 트래픽이 많이 발생할때, 여러대의 서버가 분산처리하여 서버의 로드율 증가, 부하량, 속도 저하 등을 고려하여 적절히 분산처리하여 해결


##### 종류

- L2
> - Mac 주소를 바탕으로 Load Balancing

- L3
> - IP주소를 바탕으로 Load Balancing

- L4
> - Transport Layer(IP, Port) Level 에서 Load Balancing
> - TCP, UDP

- L7
> - Application Layer(사용자의 Request) Level에서 Load Balancing
> - HTTP, HTTPS, FTP


### 로드 밸런서 장애 대비는?
- Load Balancer를 이중화하여 장애 대비

##### 장애가 났을 경우
- 이중화된 Load Balancer 들은 서로 Health Check
- Main Load Balancer 가 동작하지 않으면 가상IP(VIP)가 Secondary Load Balancer 로 변경
- 여분의 Load Balancer 로 운영




















